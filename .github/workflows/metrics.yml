#.github/workflows/metrics.yml
name: GitHub Metrics Generation

on:
  # Schedule: Run automatically every day at 00:00 UTC to ensure data freshness
  schedule:
    - cron: "0 0 * * *" # Runs every day at 00:00 UTC
  # Manual Trigger: Allows you to run the workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  github-metrics:
    # Use a standard, modern runner environment
    runs-on: ubuntu-24.04
    timeout-minutes: 10
    
    # Crucial step: The workflow requires 'write' permission to commit the generated SVG file
    permissions:
      contents: write

    steps:
      - uses: lowlighter/metrics@latest
        with:
          # CORE PARAMETER: The Personal Access Token (PAT)
          # IMPORTANT: Store this token as a repository secret named METRICS_TOKEN. 
          # It requires scopes (e.g., 'public_repo') to retrieve full data. 
          token: ${{ secrets.METRICS_TOKEN }}
          
          # OUTPUT CONFIGURATION
          # The generated SVG will be committed to the root of your repository
          filename: github-metrics.svg
          # Dynamically set the user to the repository owner
          user: ${{ github.repository_owner }}
          
          # BASE SECTIONS: Enable standard visualizations
          base: header, activity, community, repositories, metadata
          
          # PLUGIN 1: Languages Activity (Replaces complex animations with meaningful data) [2]
          plugin_languages: yes
          plugin_languages_limit: 8
          plugin_languages_threshold: 2%
          plugin_languages_colors: github
          
          # PLUGIN 2: Coding Habits (Show activity time distribution) [2]
          plugin_habits: yes
          plugin_habits_charts: yes
          plugin_habits_from: 200 # Analyze contributions over the last 200 days
          plugin_habits_days: 7 # Analyze most recent 7 days
